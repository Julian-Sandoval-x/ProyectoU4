document.addEventListener("DOMContentLoaded",(()=>{const e=document.querySelector(".register-form"),t=document.getElementById("messageContainer"),r=document.getElementById("welcomeMessage");e.addEventListener("submit",(async e=>{e.preventDefault();const n=document.getElementById("username").value.trim(),o=document.getElementById("email").value.trim(),s=document.getElementById("password").value.trim(),l=document.getElementById("confirm_password").value.trim();let a=!1;if(t.innerHTML="",r.style.display="none",""===n?(document.getElementById("usernameError").style.display="block",a=!0):document.getElementById("usernameError").style.display="none",""!==o&&function(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(String(e).toLowerCase())}(o)?document.getElementById("emailError").style.display="none":(document.getElementById("emailError").style.display="block",a=!0),""===s||s.length<8||!/\d/.test(s)?(document.getElementById("passwordError").style.display="block",a=!0):document.getElementById("passwordError").style.display="none",s!==l?(document.getElementById("confirmPasswordError").style.display="block",a=!0):document.getElementById("confirmPasswordError").style.display="none",a)return void(t.innerHTML='<div class="alert alert-danger">Por favor, corrige los errores en el formulario.</div>');const d={username:n,email:o,password:s};try{const e=await fetch("/create_user",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(d)});if(e.ok)t.innerHTML='<div class="alert alert-success">Usuario registrado con éxito</div>',setTimeout((()=>{window.location.href="/login.html"}),2e3);else{const r=await e.json();t.innerHTML=`<div class="alert alert-danger">Error: ${r.message}</div>`}}catch(e){console.error("Error al registrar el usuario:",e),t.innerHTML='<div class="alert alert-danger">Error al registrar el usuario. Por favor, inténtelo de nuevo.</div>'}}))}));