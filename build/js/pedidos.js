function cancelarPedido(e,o){fetch(`/api/pedidos/${e}/cancelar`,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${o}`}}).then((e=>{if(!e.ok)throw new Error("No se pudo cancelar el pedido");return e.json()})).then((o=>{alert(`El pedido #${e} ha sido cancelado.`),window.location.reload()})).catch((e=>{console.error("Error:",e),alert("Error al cancelar el pedido. Por favor, inténtelo de nuevo.")}))}document.addEventListener("DOMContentLoaded",(()=>{document.getElementById("backButton").addEventListener("click",(()=>{window.location.href="/index.html"}));const e=localStorage.getItem("authToken");if(!e)return alert("Por favor, inicia sesión para ver tus pedidos."),void(window.location.href="/login.html");fetch("/api/pedidos",{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`}}).then((e=>{if(!e.ok)throw new Error("Error al obtener los pedidos");return e.json()})).then((o=>{const n=document.getElementById("pedidosContainer");if(0===o.length)n.innerHTML="<p>No tienes pedidos.</p>";else{o.forEach((e=>{const o=document.createElement("div");o.classList.add("pedido"),o.innerHTML=`\n            <h3>Pedido #${e.id}</h3>\n            <p>Folio: ${e.folio}</p>\n            <p>Fecha: ${new Date(e.fecha).toLocaleString()}</p>\n            <p>Total: $${e.total}</p>\n            <p>Estado: <span class="estado">${e.estado}</span></p>\n            ${"pendiente"===e.estado.toLowerCase()?'<button class="cancelar-btn" data-id="'+e.id+'">Cancelar</button>':""}\n          `,n.appendChild(o)}));document.querySelectorAll(".cancelar-btn").forEach((o=>{o.addEventListener("click",(()=>{cancelarPedido(o.getAttribute("data-id"),e)}))}))}})).catch((e=>{console.error("Error:",e),alert("Error al obtener los pedidos. Por favor, inténtelo de nuevo.")}))}));