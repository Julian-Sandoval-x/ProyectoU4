document.addEventListener("DOMContentLoaded",(()=>{const e=document.querySelector(".login-form"),t=document.getElementById("loginError");e&&e.addEventListener("submit",(async e=>{e.preventDefault();const o=document.getElementById("email").value.trim(),n=document.getElementById("password").value.trim();let r=!1;if(t.style.display="none",""!==o&&function(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(String(e).toLowerCase())}(o)?document.getElementById("emailError").style.display="none":(document.getElementById("emailError").style.display="block",r=!0),""===n?(document.getElementById("passwordError").style.display="block",r=!0):document.getElementById("passwordError").style.display="none",r)return t.style.display="block",void(t.innerHTML="Por favor, corrige los errores en el formulario.");const s={email:o,password:n};try{const e=await fetch("/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(e.ok){const o=await e.json();localStorage.setItem("authToken",o.token),t.style.display="none",alert("Inicio de sesión exitoso"),window.location.href="/menu.html"}else{const o=await e.json();t.style.display="block",t.innerHTML=`Error: ${o.message}`}}catch(e){console.error("Error al iniciar sesión:",e),t.style.display="block",t.innerHTML="Error al iniciar sesión. Por favor, inténtelo de nuevo."}}))}));